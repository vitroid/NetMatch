[netmatch5a]{.s1}は、大きなネットワークAの中に含まれる、小さなネットワークBを捜しだすツールです。Aを過冷却水の構造、Bを氷の部分構造とすると、過冷却水の中に含まれる、局所的な氷状構造を見付けだすことができます。

```
Usage:

netmatch5a small.ngph large.ngph [d_e]
```
`d_e`は編集距離で、0以外の数値を指定すると、完全に一致しないグラフでもマッチします。(そのはず。使ったことない)

入力ファイルはいずれも@NGPH形式で、これは次のような構造を持ちます。

```
@NGPH
6
0 3
2 4
1 2
-1 -1
```

* 最初は次の5文字からなるタグ行です。ファイルの先頭でなくても構いません。
* その次の行が分子数(グラフの頂点数)N
* 以降が、辺でつながった頂点の対を表します。頂点番号は0～N-1の整数で表します。辺の向きや、データの順序は無視されます。

例えば、以下のデータは上のデータと同じトポロジーを表現します。
```
@NGPH
6
2 1
0 3
4 2
-1 -1
```

データ長は可変長で、終わりは-1 -1です。

出力は@FRAG形式です。
```
@FRAG
n m
a0 a1 a2 a3 a4 a5 a6 a7 ...
b0 b1 b2 b3 b4 b5 b6 ...
.....
-1 -1 -1 -1 -1 -1 -1 \...
```

n、mは、それぞれ小ネットワークと大ネットワークの頂点数(分子数)です。

```
\@FRAG
12 3456
1 353 402 216 215 207 395 88 203 144 223 14
8 223 96 94 146 380 215 134 385 9 147 10
-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
```

この例では、3456頂点の大きなネットワークの中に、12頂点の小さなネットワークと同じ局所トポロジーが2箇所見付かりました。みつけた部分構造の、大きなネットワークでの頂点番号が順番に出力されます。

対称性の高いフラグメントの場合、局所構造が同じ場所で何度もマッチする場合があります。例えば氷Ihのフラグメントの場合、回転と鏡映で(たぶん)12回マッチしてしまいます。

マッチした回数だけ知りたいのであれば、netmatch5aの出力したフラグメントの個数を単純に12で割れば良いのですが、もしpermutationを除いて、異なる場所のフラグメントを各1回だけとりだしたい、という場合は、cookfragment.pyを通します。組み合わせ方はMakefileを参考にして下さい。

重複をとりのぞき、`@FRAG`形式で出力したい場合。
```
netmatch5a small.ngph large.ngph | python cookfragment.py > large.frag
```

重複をとりのぞき、`@NGPH`形式で出力したい場合。
```
netmatch5a barrelan.ngph test.ngph | python cookfragment.py | python frag2ngph barrelan.ngph > test.barrelan.ngph
```

## おまけ

### `lammps2ngph.py`
LAMMPS形式の座標データをmW水分子モデルの分子位置とみなし、グラフに変換します。

### `lammps2yap.py`
LAMMPS形式の座標データをmW水分子モデルの分子位置とみなし、yaplotに変換します。引数には、上の方法でパターンマッチで得られたサブグラフデータ(@NGPH形式)を与えます。

```
lammps2yap.py test.barrelan.ngph test.ice1h2.ngph test.ice1c.ngph < test.lammpstrj
```
